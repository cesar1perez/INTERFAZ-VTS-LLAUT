<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Interfaz VTS LLAN/AUT</title>
  <script src="https://cdn.jsdelivr.net/npm/react@18/umd/react.development.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0/dist/chartjs-plugin-datalabels.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&family=Inter:wght@400;500&display=swap" rel="stylesheet">
  <style>
    body {
      background: linear-gradient(135deg, #0f172a, #1e293b);
      position: relative;
      overflow-x: hidden;
      font-family: 'Inter', sans-serif;
      color: #e2e8f0;
    }
    /* Marco profesional para el contenedor principal */
    .container {
      background: linear-gradient(145deg, #1e293b, #0f172a);
      border: 2px solid rgba(96, 165, 250, 0.3);
      border-radius: 1.5rem;
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5);
      padding: 2rem;
      margin: 1rem auto;
      position: relative;
      overflow: hidden;
    }
    .container::before {
      content: '';
      position: absolute;
      top: -2px;
      left: -2px;
      right: -2px;
      bottom: -2px;
      border-radius: 1.5rem;
      background: linear-gradient(45deg, #60a5fa, #a78bfa);
      z-index: -1;
      opacity: 0.2;
    }
    /* Estilo del header */
    .header-container {
      position: relative;
      background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAACgCAMAAADkTV1aAAAAA1BMVEUAAACnej3aAAAASElEQVR4nO3BMQEAAADCoPVPbQwfoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPCHYAAACgAABT3c1YAAAAAElFTkSuQmCC') center/cover no-repeat;
      background-blend-mode: overlay;
      opacity: 0.9;
      padding: 2rem 1rem;
      border-radius: 1rem;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.4);
      margin-bottom: 2rem;
      text-align: center;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    .header-container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(to bottom, rgba(15, 23, 42, 0.9), rgba(15, 23, 42, 0.6));
      border-radius: 1rem;
    }
    .header-container h1, .header-container p {
      position: relative;
      z-index: 1;
    }
    .header-3d {
      font-family: 'Poppins', sans-serif;
      font-weight: 800;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5), 
                   -1px -1px 2px rgba(255, 255, 255, 0.2);
    }
    /* Estilo para botones (excepto Prospecciones) */
    .custom-button {
      background: linear-gradient(145deg, #1e40af, #3b82f6);
      border: 2px solid #60a5fa;
      border-radius: 0.75rem;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2), inset 0 2px 4px rgba(255, 255, 255, 0.2);
      transition: all 0.3s ease;
      padding: 1rem 2rem;
      font-family: 'Poppins', sans-serif;
      font-weight: 600;
      color: #ffffff;
      position: relative;
    }
    .custom-button:hover {
      background: linear-gradient(145deg, #2563eb, #60a5fa);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3), inset 0 3px 6px rgba(255, 255, 255, 0.3);
      transform: translateY(-2px);
    }
    /* Estilo para selects */
    .custom-select {
      background: linear-gradient(145deg, #1e293b, #0f172a);
      border: 2px solid #60a5fa;
      border-radius: 0.5rem;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2), inset 0 1px 2px rgba(0, 0, 0, 0.5);
      transition: all 0.3s ease;
      font-family: 'Inter', sans-serif;
    }
    .custom-select:hover {
      border-color: #93c5fd;
      box-shadow: 0 6px 8px rgba(0, 0, 0, 0.3), inset 0 2px 4px rgba(0, 0, 0, 0.5);
    }
    /* Estilo para las tablas */
    .table-header {
      background: linear-gradient(to right, #7c3aed, #3b82f6);
    }
    .prospect-table-header {
      background: linear-gradient(to right, #10b981, #34d399);
    }
    /* Marcos para secciones de tablas y gráficos */
    .section-frame {
      background: #1e293b;
      border: 2px solid rgba(96, 165, 250, 0.5);
      border-radius: 1rem;
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
      padding: 1.5rem;
      position: relative;
      overflow: hidden;
    }
    .section-frame::before {
      content: '';
      position: absolute;
      top: -2px;
      left: -2px;
      right: -2px;
      bottom: -2px;
      border-radius: 1rem;
      background: linear-gradient(45deg, #60a5fa, #a78bfa);
      z-index: -1;
      opacity: 0.1;
    }
    /* Estilo para los encabezados de sección */
    .section-title {
      font-family: 'Poppins', sans-serif;
      font-weight: 600;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
      border-bottom: 2px solid #60a5fa;
      padding-bottom: 0.5rem;
      margin-bottom: 1rem;
    }
    /* Watermark */
    .watermark {
      position: absolute;
      z-index: -1;
      opacity: 0.15;
      pointer-events: none;
    }
    .watermark-logo-roma {
      bottom: 20px;
      right: 20px;
      width: 300px;
      height: 100px;
      background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAT4AAACgCAMAAADkTV1aAAAAA1BMVEUAAACnej3aAAAASElEQVR4nO3BMQEAAADCoPVPbQwfoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPCHYAAACgAABT3c1YAAAAAElFTkSuQmCC') no-repeat center;
      background-size: contain;
    }
    /* Media Queries */
    @media (max-width: 640px) {
      table { font-size: 0.65rem; }
      th, td { padding: 0.4rem; }
      .container { padding: 1rem; }
      select { font-size: 0.8rem; padding: 0.5rem; }
      h1 { font-size: 1.75rem; }
      h2 { font-size: 1.5rem; }
      canvas { max-height: 250px; }
      .custom-button { padding: 0.75rem 1.5rem; font-size: 0.9rem; }
      .section-frame { padding: 1rem; }
    }
    @media (min-width: 641px) {
      table { font-size: 0.85rem; }
      th, td { padding: 0.75rem; }
      select { font-size: 0.9rem; padding: 0.75rem; }
      canvas { max-height: 350px; }
    }
  </style>
</head>
<body class="min-h-screen">
  <div class="watermark watermark-logo-roma"></div>
  <div id="root" class="container mx-auto"></div>

  <script type="text/babel">
    function parseNumber(value) {
      if (!value || value === "") return 0;
      const cleaned = String(value).replace(/[^0-9.-]+/g, '');
      return Number(cleaned) || 0;
    }

    function getMonthName(dateString) {
      if (!dateString || dateString.trim() === "") return "Mes desconocido";
      let date;
      const cleanedDateString = dateString.trim().replace(/\s+/g, ' ');
      
      const formats = [
        { regex: /^(\d{1,2})\/(\d{1,2})\/(\d{4})\s+(\d{1,2}):(\d{2}):(\d{2})$/, parse: (match) => new Date(`${match[3]}-${match[2]}-${match[1]}T${match[4]}:${match[5]}:${match[6]}`) },
        { regex: /^(\d{1,2})\/(\d{1,2})\/(\d{4})$/, parse: (match) => new Date(`${match[3]}-${match[2]}-${match[1]}`) },
        { regex: /^(\d{4})-(\d{1,2})-(\d{1,2})\s+(\d{1,2}):(\d{2}):(\d{2})$/, parse: (match) => new Date(`${match[1]}-${match[2]}-${match[3]}T${match[4]}:${match[5]}:${match[6]}`) },
        { regex: /^(\d{4})-(\d{1,2})-(\d{1,2})$/, parse: (match) => new Date(`${match[1]}-${match[2]}-${match[3]}`) },
        { regex: /^(\d{1,2})-(\d{1,2})-(\d{4})$/, parse: (match) => new Date(`${match[3]}-${match[1]}-${match[2]}`) },
        { regex: /^(\d{4})\/(\d{1,2})\/(\d{1,2})$/, parse: (match) => new Date(`${match[1]}-${match[2]}-${match[3]}`) },
      ];

      for (const format of formats) {
        const match = cleanedDateString.match(format.regex);
        if (match) {
          date = format.parse(match);
          break;
        }
      }

      if (!date || isNaN(date?.getTime())) {
        date = new Date(cleanedDateString);
      }

      if (isNaN(date?.getTime())) {
        const parts = cleanedDateString.split(/[\s\/-]+/);
        if (parts.length >= 3) {
          date = new Date(`${parts[2]}-${parts[1]}-${parts[0]}`);
          if (isNaN(date?.getTime())) {
            date = new Date(`${parts[2]}-${parts[0]}-${parts[1]}`);
          }
        }
      }

      if (isNaN(date?.getTime())) {
        console.warn(`No se pudo parsear la fecha: "${dateString}"`);
        return "Mes desconocido";
      }

      const monthNames = [
        "Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio",
        "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"
      ];
      return monthNames[date.getMonth()];
    }

    function SalesTable() {
      const [data, setData] = React.useState([]);
      const [prospectData, setProspectData] = React.useState([]);
      const [filterVend, setFilterVend] = React.useState([]);
      const [filterClas, setFilterClas] = React.useState("");
      const [filterDate, setFilterDate] = React.useState("");
      const [filterClients, setFilterClients] = React.useState([]);
      const [prospectFilterVend, setProspectFilterVend] = React.useState([]);
      const [prospectFilterMonth, setProspectFilterMonth] = React.useState("");
      const [view, setView] = React.useState("home");
      const tableRef = React.useRef(null);
      const prospectTableRef = React.useRef(null);
      const chartRef = React.useRef(null);
      const prospectChartRef = React.useRef(null);
      const chartInstanceRef = React.useRef(null);
      const prospectChartInstanceRef = React.useRef(null);
      const [error, setError] = React.useState(null);
      const [prospectError, setProspectError] = React.useState(null);
      const [isLoading, setIsLoading] = React.useState(true);

      const vendorNames = {
        "3": "Carlos Calderón",
        "4": "Marco Hernández",
        "6": "Miguel Lozada",
        "5": "Ulises Alvarado",
        "7": "Alfredo Tapia",
        "8": "Empresarial/Talleres",
        "12": "Ruben León",
        "23": "Enrique Reséndiz",
        "71": "Cecilia Pérez",
        "72": "Oscar Flóres",
        "22": "Cecilio Ivan",
        "21": "Celene Soto"
      };

      const vendorColors = {
        "3": "#FF6F61",  // Coral
        "4": "#D4A5A5",  // Rosa claro
        "6": "#6B7280",  // Gris
        "5": "#FBBF24",  // Amarillo ámbar
        "7": "#34D399",  // Verde esmeralda
        "8": "#60A5FA",  // Azul claro
        "12": "#F472B6", // Rosa
        "23": "#A78BFA", // Púrpura claro
        "71": "#FCD34D", // Amarillo dorado
        "72": "#4ADE80", // Verde lima
        "22": "#2DD4BF", // Turquesa
        "21": "#F87171"  // Rojo claro
      };

      const getVendorColor = (vendorName) => {
        const vendorCode = Object.keys(vendorNames).find(key => vendorNames[key] === vendorName);
        return vendorColors[vendorCode] || '#FFFFFF';
      };

      const vendorCodes = React.useMemo(() => [...new Set(data.map(item => item.codVend))].sort(), [data]);
      const clasificaciones = React.useMemo(() => [...new Set(data.map(item => item.clasificacion))].sort(), [data]);
      const fechas = React.useMemo(() => [...new Set(data.map(item => item.fecha))].sort(), [data]);
      const clientes = React.useMemo(() => [...new Set(data.map(item => item.cliente))].sort(), [data]);
      const prospectVendors = React.useMemo(() => [...new Set(prospectData.map(item => item["Vendedor"]))].sort(), [prospectData]);
      const prospectMonths = React.useMemo(() => {
        const months = prospectData
          .map(item => getMonthName(item["Hora de inicio"]))
          .filter(month => month !== "Mes desconocido");
        return [...new Set(months)].sort();
      }, [prospectData]);

      const filteredData = React.useMemo(() => {
        let result = [...data];
        if (filterVend.length > 0) result = result.filter(item => filterVend.includes(item.codVend));
        if (filterClas) result = result.filter(item => item.clasificacion === filterClas);
        if (filterDate) result = result.filter(item => item.fecha === filterDate);
        if (filterClients.length > 0) {
          result = result.filter(item => filterClients.includes(item.cliente));
        }
        return result.sort((a, b) => b.importe - a.importe);
      }, [data, filterVend, filterClas, filterDate, filterClients]);

      const filteredProspectData = React.useMemo(() => {
        let result = [...prospectData];
        if (prospectFilterVend.length > 0) {
          result = result.filter(item => prospectFilterVend.includes(item["Vendedor"]));
        }
        if (prospectFilterMonth) {
          result = result.filter(item => getMonthName(item["Hora de inicio"]) === prospectFilterMonth);
        }
        return result;
      }, [prospectData, prospectFilterVend, prospectFilterMonth]);

      const totals = React.useMemo(() => {
        return filteredData.reduce(
          (acc, item) => {
            acc.cantidad += item.cantidad;
            acc.importe += item.importe;
            return acc;
          },
          { cantidad: 0, importe: 0 }
        );
      }, [filteredData]);

      const prospectTotals = React.useMemo(() => {
        const totalsByVendor = filteredProspectData.reduce((acc, item) => {
          const vendor = item["Vendedor"] || "Desconocido";
          if (!acc[vendor]) {
            acc[vendor] = 0;
          }
          acc[vendor] += 1;
          return acc;
        }, {});
        return totalsByVendor;
      }, [filteredProspectData]);

      const prospectTotalsByMonth = React.useMemo(() => {
        const totalsByVendorAndMonth = filteredProspectData.reduce((acc, item) => {
          const vendor = item["Vendedor"] || "Desconocido";
          const month = getMonthName(item["Hora de inicio"]);
          if (!acc[vendor]) {
            acc[vendor] = {};
          }
          if (!acc[vendor][month]) {
            acc[vendor][month] = 0;
          }
          acc[vendor][month] += 1;
          return acc;
        }, {});
        console.log("Conteo de prospecciones por vendedor y mes:", totalsByVendorAndMonth);
        return totalsByVendorAndMonth;
      }, [filteredProspectData]);

      const vendorTotals = React.useMemo(() => {
        const totalsByVendor = filteredData.reduce((acc, item) => {
          if (!acc[item.codVend]) {
            acc[item.codVend] = 0;
          }
          acc[item.codVend] += item.cantidad;
          return acc;
        }, {});
        return Object.entries(totalsByVendor)
          .map(([vendor, cantidad]) => ({ vendor, cantidad }))
          .sort((a, b) => b.cantidad - a.cantidad);
      }, [filteredData]);

      const prospectChartTotals = React.useMemo(() => {
        const totalsByVendor = filteredProspectData.reduce((acc, item) => {
          const vendor = item["Vendedor"] || "Desconocido";
          if (!acc[vendor]) {
            acc[vendor] = 0;
          }
          acc[vendor] += 1;
          return acc;
        }, {});
        return Object.entries(totalsByVendor)
          .map(([vendor, count]) => ({ vendor, count }))
          .sort((a, b) => b.count - a.count);
      }, [filteredProspectData]);

      const getColor = (value, type) => {
        if (type === "cantidad") return value > 15 ? "bg-green-500 text-black" : value < 5 ? "bg-red-500 text-white" : "bg-yellow-400 text-black";
        return "";
      };

      React.useEffect(() => {
        const csvUrl = "https://docs.google.com/spreadsheets/d/1Oa4a5rJp0W2IhIlAa5iwCCWOK9KkRgQp/export?format=csv";
        const fetchData = () => {
          const scrollPosition = tableRef.current ? tableRef.current.scrollLeft : 0;
          Papa.parse(csvUrl, {
            download: true,
            header: true,
            skipEmptyLines: true,
            complete: (result) => {
              const parsedData = result.data.map(row => ({
                codVend: row["COD DE VEND"] || "",
                cantidad: parseNumber(row["CANTIDAD"]),
                importe: parseNumber(row["IMPORTE"]),
                cliente: row["NOMBRE DEL CLIENTE"] || "",
                codCliente: row["CODIGO DEL CLIENTE"] || "",
                clasificacion: row["CLASIFICACION"] || "",
                almacen: row["ALMACEN"] || "",
                factura: row["FACTURA"] || "",
                descuento: parseNumber(row["DESCUENTO"]),
                descripcion: row["DESCRIPCION"] || "",
                fecha: row["FECHA"] || "",
              }));
              setData(parsedData);
              setError(null);
              setIsLoading(false);
              if (tableRef.current) {
                tableRef.current.scrollLeft = scrollPosition;
              }
            },
            error: (error) => {
              console.error("Error al cargar el CSV desde Google Drive:", error);
              setError("No se pudo cargar los datos. Por favor, verifica la conexión o la URL del CSV.");
              setIsLoading(false);
            },
          });
        };
        fetchData();
        const interval = setInterval(fetchData, 60000);
        return () => clearInterval(interval);
      }, []);

      React.useEffect(() => {
        const prospectCsvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTXGkF1hNnpv4ZJAq5KifgTerrdDLFQGdBdiHrfsoQLX75EBsnRMN6HZ6HESCkFWbO7HL6tAcBY48zo/pub?output=csv";
        const fetchProspectData = () => {
          Papa.parse(prospectCsvUrl, {
            download: true,
            header: true,
            skipEmptyLines: true,
            complete: (result) => {
              const expectedColumns = ["Vendedor", "Nombre del cliente", "Giro del Negocio", "Zona", "Teléfono", "Hora de inicio"];
              const headers = result.meta.fields || [];
              const missingColumns = expectedColumns.filter(col => !headers.includes(col));
              
              if (missingColumns.length > 0) {
                setProspectError(`Faltan las siguientes columnas en el archivo: ${missingColumns.join(", ")}. Asegúrate de que la pestaña correcta esté publicada y contenga estas columnas.`);
                return;
              }

              console.log("Primeras 5 fechas en 'Hora de inicio':", result.data.slice(0, 5).map(row => row["Hora de inicio"]));
              setProspectData(result.data);
              setProspectError(null);
            },
            error: (error) => {
              console.error("Error al cargar el CSV de prospecciones desde Google Sheets:", error);
              setProspectError("No se pudo cargar los datos de prospecciones. Por favor, verifica la conexión o la URL del CSV.");
            },
          });
        };
        fetchProspectData();
        const interval = setInterval(fetchProspectData, 60000);
        return () => clearInterval(interval);
      }, []);

      React.useEffect(() => {
        if (chartRef.current && vendorTotals.length > 0 && view === "leaders") {
          if (chartInstanceRef.current) {
            chartInstanceRef.current.destroy();
          }

          const maxCantidad = Math.max(...vendorTotals.map(item => item.cantidad));
          const suggestedMax = maxCantidad * 1.5;

          const ctx = chartRef.current.getContext('2d');
          chartInstanceRef.current = new Chart(ctx, {
            type: 'bar',
            data: {
              labels: vendorTotals.map(item => vendorNames[item.vendor] || item.vendor),
              datasets: [{
                label: 'Cantidad por Vendedor',
                data: vendorTotals.map(item => item.cantidad),
                backgroundColor: vendorTotals.map(item => vendorColors[item.vendor] || '#FFFFFF'),
                borderColor: '#FFFFFF',
                borderWidth: 1,
                barThickness: 15,
              }],
            },
            options: {
              indexAxis: 'x',
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                legend: { display: false },
                tooltip: {
                  backgroundColor: '#1e293b',
                  titleColor: '#FFFFFF',
                  bodyColor: '#FFFFFF',
                  borderColor: '#60a5fa',
                  borderWidth: 1,
                },
                datalabels: {
                  anchor: 'end',
                  align: 'top',
                  color: '#FFFFFF',
                  font: { size: 12, family: 'Inter' },
                  backgroundColor: 'rgba(0, 0, 0, 0.5)',
                  borderRadius: 3,
                  padding: 2,
                  formatter: (value) => value.toLocaleString(),
                  rotation: -45,
                },
              },
              scales: {
                x: {
                  grid: { display: false },
                  ticks: { color: '#e2e8f0', font: { size: 10, family: 'Inter' } },
                },
                y: {
                  grid: { display: false },
                  ticks: { color: '#e2e8f0', font: { size: 10, family: 'Inter' } },
                  beginAtZero: true,
                  suggestedMax: suggestedMax,
                },
              },
              layout: {
                padding: { top: 30 },
              },
            },
            plugins: [ChartDataLabels],
          });
        }
        return () => {
          if (chartInstanceRef.current) {
            chartInstanceRef.current.destroy();
          }
        };
      }, [vendorTotals, view]);

      React.useEffect(() => {
        if (prospectChartRef.current && prospectChartTotals.length > 0 && view === "prospects") {
          if (prospectChartInstanceRef.current) {
            prospectChartInstanceRef.current.destroy();
          }

          const maxCount = Math.max(...prospectChartTotals.map(item => item.count));
          const suggestedMax = maxCount * 1.5;

          const ctx = prospectChartRef.current.getContext('2d');
          prospectChartInstanceRef.current = new Chart(ctx, {
            type: 'bar',
            data: {
              labels: prospectChartTotals.map(item => item.vendor),
              datasets: [{
                label: 'Prospecciones por Vendedor',
                data: prospectChartTotals.map(item => item.count),
                backgroundColor: prospectChartTotals.map(item => getVendorColor(item.vendor)),
                borderColor: '#FFFFFF',
                borderWidth: 1,
                barThickness: 15,
              }],
            },
            options: {
              indexAxis: 'x',
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                legend: { display: false },
                tooltip: {
                  backgroundColor: '#1a1a3d',
                  titleColor: '#FFFFFF',
                  bodyColor: '#FFFFFF',
                  borderColor: '#00FFFF',
                  borderWidth: 1,
                },
                datalabels: {
                  anchor: 'end',
                  align: 'top',
                  color: '#FFFFFF',
                  font: { size: 12 },
                  backgroundColor: 'rgba(0, 0, 0, 0.5)',
                  borderRadius: 3,
                  padding: 2,
                  formatter: (value) => value.toLocaleString(),
                  rotation: -45,
                },
              },
              scales: {
                x: {
                  grid: { display: false },
                  ticks: { color: '#FFFFFF', font: { size: 10 } },
                },
                y: {
                  grid: { display: false },
                  ticks: { color: '#FFFFFF', font: { size: 10 } },
                  beginAtZero: true,
                  suggestedMax: suggestedMax,
                },
              },
              layout: {
                padding: { top: 30 },
              },
            },
            plugins: [ChartDataLabels],
          });
        }
        return () => {
          if (prospectChartInstanceRef.current) {
            prospectChartInstanceRef.current.destroy();
          }
        };
      }, [prospectChartTotals, view]);

      const handleVendorChange = (e) => {
        const selectedOptions = Array.from(e.target.selectedOptions).map(option => option.value);
        if (selectedOptions.includes("")) {
          setFilterVend([]);
        } else {
          const selected = selectedOptions.filter(option => option !== "").slice(0, 3);
          setFilterVend(selected);
        }
      };

      const handleClientChange = (e) => {
        const selectedOptions = Array.from(e.target.selectedOptions).map(option => option.value);
        if (selectedOptions.includes("")) {
          setFilterClients([]);
        } else {
          const selected = selectedOptions.filter(option => option !== "").slice(0, 2);
          setFilterClients(selected);
        }
      };

      const handleProspectVendorChange = (e) => {
        const selectedOptions = Array.from(e.target.selectedOptions).map(option => option.value);
        if (selectedOptions.includes("")) {
          setProspectFilterVend([]);
        } else {
          const selected = selectedOptions.filter(option => option !== "").slice(0, 3);
          setProspectFilterVend(selected);
        }
      };

      const resetClientFilter = () => {
        setFilterClients([]);
        const selectElement = document.querySelector('select[multiple]:last-of-type');
        if (selectElement) {
          selectElement.value = [];
        }
      };

      const resetProspectVendorFilter = () => {
        setProspectFilterVend([]);
        const selectElement = document.querySelector('select[multiple]:last-of-type');
        if (selectElement) {
          selectElement.value = [];
        }
      };

      const resetProspectMonthFilter = () => {
        setProspectFilterMonth("");
        const selectElement = document.querySelector('select:not([multiple]):last-of-type');
        if (selectElement) {
          selectElement.value = "";
        }
      };

      const renderHome = () => (
        <div className="flex flex-col items-center gap-8">
          {isLoading ? (
            <p className="text-lg sm:text-xl text-blue-300 text-center font-semibold">
              Cargando la interfaz, por favor espera...
            </p>
          ) : (
            <>
              <div className="header-container w-full">
                <h1 className="text-3xl sm:text-4xl font-extrabold text-white mb-2 tracking-wide header-3d">INTERFAZ - VTS - LLAN/AUT</h1>
                <p className="text-sm sm:text-base text-blue-200 header-3d">
                  Información confidencial · Uso interno exclusivo · Prohibida su reproducción sin autorización
                </p>
              </div>
              <p className="text-lg sm:text-xl text-blue-300 text-center font-semibold">
                Bienvenido(a) a la Interfaz de Ventas. Analice y optimice el rendimiento de su equipo con nuestras herramientas avanzadas.
              </p>
              <div className="flex flex-col sm:flex-row gap-6 flex-wrap justify-center">
                <div className="flex flex-col items-center">
                  <button
                    onClick={() => setView("leaders")}
                    className="custom-button"
                  >
                    Tabla de Líderes
                  </button>
                  <ul className="text-sm text-gray-300 mt-2 list-disc list-inside">
                    <li>Visualice el ranking de vendedores por cantidad.</li>
                    <li>Compare el desempeño con gráficos dinámicos.</li>
                    <li>Filtre por vendedor, fecha y más.</li>
                  </ul>
                </div>
                <div className="flex flex-col items-center">
                  <button
                    onClick={() => setView("results")}
                    className="custom-button"
                  >
                    Tabla de Resultados
                  </button>
                  <ul className="text-sm text-gray-300 mt-2 list-disc list-inside">
                    <li>Revise detalles de facturación por factura.</li>
                    <li>Analice importes y cantidades por cliente.</li>
                    <li>Filtre por clasificación, cliente y más.</li>
                  </ul>
                </div>
                <div className="flex flex-col items-center">
                  <button
                    onClick={() => setView("prospects")}
                    className="bg-blue-600 text-white px-6 py-3 rounded-lg shadow-lg hover:bg-blue-700 transition-colors text-lg font-semibold"
                  >
                    Prospecciones
                  </button>
                  <ul className="text-sm text-gray-300 mt-2 list-disc list-inside">
                    <li>Visualice el número de prospecciones por vendedor.</li>
                    <li>Compare el desempeño con gráficos dinámicos.</li>
                    <li>Acceda al detalle en <a href="https://docs.google.com/spreadsheets/d/1bDX8oigvIYMDOGcroRtAhryuEwPbAkcs9gU4Z9e6wLU/edit?usp=sharing" target="_blank" rel="noopener noreferrer" className="text-blue-400 hover:underline">Google Sheets</a>.</li>
                  </ul>
                </div>
                <div className="flex flex-col items-center">
                  <button
                    onClick={() => setView("formLinks")}
                    className="custom-button"
                  >
                    Enlaces a Formularios
                  </button>
                  <ul className="text-sm text-gray-300 mt-2 list-disc list-inside">
                    <li>Acceda a formularios para prospectos.</li>
                    <li>Registre datos de INEGI.</li>
                    <li>Consulte precios de lubricantes de la competencia.</li>
                  </ul>
                </div>
                <div className="flex flex-col items-center">
                  <button
                    onClick={() => setView("dailyReports")}
                    className="custom-button bg-gradient-to-r from-red-600 to-red-400 border-red-500 hover:bg-gradient-to-r hover:from-red-500 hover:to-red-300"
                  >
                    Reporte Diario
                  </button>
                  <ul className="text-sm text-gray-300 mt-2 list-disc list-inside">
                    <li>Acceda a los reportes diarios por vendedor.</li>
                    <li>Disponible en OneDrive para consulta autorizada.</li>
                  </ul>
                </div>
              </div>
            </>
          )}
        </div>
      );

      const renderDailyReports = () => (
        <div className="space-y-6">
          <div className="header-container">
            <h1 className="text-3xl sm:text-4xl font-extrabold text-white mb-2 tracking-wide header-3d">INTERFAZ - VTS - LLAN/AUT</h1>
            <p className="text-sm sm:text-base text-blue-200 header-3d">
              Información confidencial · Uso interno exclusivo · Prohibida su reproducción sin autorización
            </p>
          </div>
          <button
            onClick={() => setView("home")}
            className="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-500 transition-colors font-semibold"
          >
            Volver al Inicio
          </button>
          <div className="section-frame flex flex-col items-center gap-6">
            <h2 className="text-2xl sm:text-3xl font-bold text-red-400 text-center section-title">Reporte Diario</h2>
            <div className="flex flex-col sm:flex-row gap-6 flex-wrap justify-center">
              <div className="flex flex-col items-center">
                <a
                  href="https://1drv.ms/x/s!AvvqXFbGQ3lJnkLZmQxYxVvVr7cB?e=2awW2U"
                  target="_blank"
                  rel="noopener noreferrer"
                  className="custom-button bg-gradient-to-r from-red-600 to-red-400 border-red-500 hover:bg-gradient-to-r hover:from-red-500 hover:to-red-300"
                >
                  Carlos Calderón
                </a>
              </div>
              <div className="flex flex-col items-center">
                <a
                  href="https://1drv.ms/x/s!AvvqXFbGQ3lJnkLZmQxYxVvVr7cB?e=2awW2U"
                  target="_blank"
                  rel="noopener noreferrer"
                  className="custom-button bg-gradient-to-r from-red-600 to-red-400 border-red-500 hover:bg-gradient-to-r hover:from-red-500 hover:to-red-300"
                >
                  Alfredo Tapia
                </a>
              </div>
              <div className="flex flex-col items-center">
                <a
                  href="https://1drv.ms/x/s!AvvqXFbGQ3lJnkLZmQxYxVvVr7cB?e=2awW2U"
                  target="_blank"
                  rel="noopener noreferrer"
                  className="custom-button bg-gradient-to-r from-red-600 to-red-400 border-red-500 hover:bg-gradient-to-r hover:from-red-500 hover:to-red-300"
                >
                  Miguel Lozada
                </a>
              </div>
              <div className="flex flex-col items-center">
                <a
                  href="https://1drv.ms/x/s!AvvqXFbGQ3lJnkLZmQxYxVvVr7cB?e=2awW2U"
                  target="_blank"
                  rel="noopener noreferrer"
                  className="custom-button bg-gradient-to-r from-red-600 to-red-400 border-red-500 hover:bg-gradient-to-r hover:from-red-500 hover:to-red-300"
                >
                  Ruben León
                </a>
              </div>
              <div className="flex flex-col items-center">
                <a
                  href="https://1drv.ms/x/s!AvvqXFbGQ3lJnkdgMYFImbu076pK?e=YROPfD"
                  target="_blank"
                  rel="noopener noreferrer"
                  className="custom-button bg-gradient-to-r from-red-600 to-red-400 border-red-500 hover:bg-gradient-to-r hover:from-red-500 hover:to-red-300"
                >
                  Enrique Reséndiz
                </a>
              </div>
              <div className="flex flex-col items-center">
                <a
                  href="https://1drv.ms/x/s!AvvqXFbGQ3lJnkSxO47Q89IB3nQe?e=cSvoc5"
                  target="_blank"
                  rel="noopener noreferrer"
                  className="custom-button bg-gradient-to-r from-red-600 to-red-400 border-red-500 hover:bg-gradient-to-r hover:from-red-500 hover:to-red-300"
                >
                  Cecilia Pérez
                </a>
              </div>
              <div className="flex flex-col items-center">
                <a
                  href="https://1drv.ms/x/s!AvvqXFbGQ3lJnkV8QaPX5icqPRgF?e=TTcjx3"
                  target="_blank"
                  rel="noopener noreferrer"
                  className="custom-button bg-gradient-to-r from-red-600 to-red-400 border-red-500 hover:bg-gradient-to-r hover:from-red-500 hover:to-red-300"
                >
                  Jesus Bolaños / Celene Soto
                </a>
              </div>
              <div className="flex flex-col items-center">
                <a
                  href="https://1drv.ms/x/s!AvvqXFbGQ3lJnkMQEmbvUylBa-h6?e=i2NheE"
                  target="_blank"
                  rel="noopener noreferrer"
                  className="custom-button bg-gradient-to-r from-red-600 to-red-400 border-red-500 hover:bg-gradient-to-r hover:from-red-500 hover:to-red-300"
                >
                  Ivan Torres
                </a>
              </div>
              <div className="flex flex-col items-center">
                <a
                  href="https://1drv.ms/x/s!AvvqXFbGQ3lJnka1_lWcs_eBVT7L?e=zGHbxS"
                  target="_blank"
                  rel="noopener noreferrer"
                  className="custom-button bg-gradient-to-r from-red-600 to-red-400 border-red-500 hover:bg-gradient-to-r hover:from-red-500 hover:to-red-300"
                >
                  Oscar Flóres
                </a>
              </div>
            </div>
          </div>
          <button
            onClick={() => setView("home")}
            className="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-500 transition-colors font-semibold"
          >
            Volver al Inicio
          </button>
        </div>
      );

      const renderFormLinks = () => (
        <div className="space-y-6">
          <div className="header-container">
            <h1 className="text-3xl sm:text-4xl font-extrabold text-white mb-2 tracking-wide header-3d">INTERFAZ - VTS - LLAN/AUT</h1>
            <p className="text-sm sm:text-base text-blue-200 header-3d">
              Información confidencial · Uso interno exclusivo · Prohibida su reproducción sin autorización
            </p>
          </div>
          <button
            onClick={() => setView("home")}
            className="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-500 transition-colors font-semibold"
          >
            Volver al Inicio
          </button>
          <div className="section-frame flex flex-col items-center gap-6">
            <h2 className="text-2xl sm:text-3xl font-bold text-blue-400 text-center section-title">Enlaces a Formularios</h2>
            <div className="flex flex-col sm:flex-row gap-6">
              <div className="flex flex-col items-center">
                <a
                  href="https://forms.office.com/Pages/ResponsePage.aspx?id=DQSIkWdsW0yxEjajBLZtrQAAAAAAAAAAAAN__oQmtexUQ0NJQlAxVlVPSERDVjBPR1ZONEtLUFVNTi4u"
                  target="_blank"
                  rel="noopener noreferrer"
                  className="custom-button bg-gradient-to-r from-green-600 to-green-400 border-green-500 hover:bg-gradient-to-r hover:from-green-500 hover:to-green-300"
                >
                  Prospectos
                </a>
                <p className="text-sm text-gray-300 mt-2">Formulario para registrar nuevos prospectos.</p>
              </div>
              <div className="flex flex-col items-center">
                <a
                  href="https://forms.office.com/Pages/ResponsePage.aspx?id=DQSIkWdsW0yxEjajBLZtrQAAAAAAAAAAAAN__oQmtexUMkU1SzBHOUExWDZDMkFMVkYwNlg0UzRNSS4u"
                  target="_blank"
                  rel="noopener noreferrer"
                  className="custom-button bg-gradient-to-r from-purple-600 to-purple-400 border-purple-500 hover:bg-gradient-to-r hover:from-purple-500 hover:to-purple-300"
                >
                  INEGI
                </a>
                <p className="text-sm text-gray-300 mt-2">Formulario para datos relacionados con INEGI.</p>
              </div>
              <div className="flex flex-col items-center">
                <a
                  href="https://forms.office.com/Pages/ResponsePage.aspx?id=DQSIkWdsW0yxEjajBLZtrQAAAAAAAAAAAAN__oQmtexUNkQ1ODdVUEpMMTUxSTIyM0VMSEpQVlk3UC4u"
                  target="_blank"
                  rel="noopener noreferrer"
                  className="custom-button bg-gradient-to-r from-orange-600 to-orange-400 border-orange-500 hover:bg-gradient-to-r hover:from-orange-500 hover:to-orange-300"
                >
                  Precios Lubricante Competencia
                </a>
                <p className="text-sm text-gray-300 mt-2">Formulario para registrar precios de lubricantes de la competencia.</p>
              </div>
            </div>
          </div>
          <button
            onClick={() => setView("home")}
            className="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-500 transition-colors font-semibold"
          >
            Volver al Inicio
          </button>
        </div>
      );

      const renderLeaders = () => (
        <div className="space-y-6">
          <div className="header-container">
            <h1 className="text-3xl sm:text-4xl font-extrabold text-white mb-2 tracking-wide header-3d">INTERFAZ - VTS - LLAN/AUT</h1>
            <p className="text-sm sm:text-base text-blue-200 header-3d">
              Información confidencial · Uso interno exclusivo · Prohibida su reproducción sin autorización
            </p>
          </div>
          <button
            onClick={() => setView("home")}
            className="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-500 transition-colors font-semibold"
          >
            Volver al Inicio
          </button>
          <div className="section-frame flex flex-col items-center gap-4">
            <h2 className="text-2xl sm:text-3xl font-bold text-blue-400 text-center section-title">Filtros de Ventas</h2>
            <div className="grid grid-cols-1 sm:grid-cols-4 gap-4 w-full">
              <select
                multiple
                size="3"
                className="p-3 rounded-lg text-white custom-select"
                value={filterVend}
                onChange={handleVendorChange}
              >
                <option value="">Todos los Vendedores</option>
                {vendorCodes.map((code) => (
                  <option key={code} value={code}>{vendorNames[code] || code}</option>
                ))}
              </select>
              <select
                className="p-3 rounded-lg text-white custom-select"
                value={filterClas}
                onChange={(e) => setFilterClas(e.target.value)}
              >
                <option value="">Todas las Clasificaciones</option>
                {clasificaciones.map((clas) => (
                  <option key={clas} value={clas}>{clas}</option>
                ))}
              </select>
              <select
                className="p-3 rounded-lg text-white custom-select"
                value={filterDate}
                onChange={(e) => setFilterDate(e.target.value)}
              >
                <option value="">Todas las Fechas</option>
                {fechas.map((fecha) => (
                  <option key={fecha} value={fecha}>{fecha}</option>
                ))}
              </select>
              <div className="flex items-center gap-2">
                <select
                  multiple
                  size="3"
                  className="p-3 rounded-lg text-white custom-select flex-1"
                  value={filterClients}
                  onChange={handleClientChange}
                >
                  <option value="">Todos los Clientes</option>
                  {clientes.map((cliente) => (
                    <option key={cliente} value={cliente}>{cliente}</option>
                  ))}
                </select>
                <button
                  onClick={resetClientFilter}
                  className="p-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors text-sm font-semibold"
                >
                  Reiniciar
                </button>
              </div>
            </div>
          </div>
          <div className="section-frame">
            <h3 className="text-lg sm:text-xl font-semibold text-blue-400 text-center mb-4 section-title">Tabla de Líderes</h3>
            {error ? (
              <p className="text-red-400 text-center">{error}</p>
            ) : (
              <div className="w-full h-[250px] sm:h-[350px]">
                <canvas ref={chartRef}></canvas>
              </div>
            )}
          </div>
          <button
            onClick={() => setView("home")}
            className="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-500 transition-colors font-semibold"
          >
            Volver al Inicio
          </button>
        </div>
      );

      const renderResults = () => (
        <div className="space-y-6">
          <div className="header-container">
            <h1 className="text-3xl sm:text-4xl font-extrabold text-white mb-2 tracking-wide header-3d">INTERFAZ - VTS - LLAN/AUT</h1>
            <p className="text-sm sm:text-base text-blue-200 header-3d">
              Información confidencial · Uso interno exclusivo · Prohibida su reproducción sin autorización
            </p>
          </div>
          <button
            onClick={() => setView("home")}
            className="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-500 transition-colors font-semibold"
          >
            Volver al Inicio
          </button>
          <div className="section-frame flex flex-col items-center gap-4">
            <h2 className="text-2xl sm:text-3xl font-bold text-blue-400 text-center section-title">Filtros de Resultados</h2>
            <div className="grid grid-cols-1 sm:grid-cols-4 gap-4 w-full">
              <select
                multiple
                size="3"
                className="p-3 rounded-lg text-white custom-select"
                value={filterVend}
                onChange={handleVendorChange}
              >
                <option value="">Todos los Vendedores</option>
                {vendorCodes.map((code) => (
                  <option key={code} value={code}>{vendorNames[code] || code}</option>
                ))}
              </select>
              <select
                className="p-3 rounded-lg text-white custom-select"
                value={filterClas}
                onChange={(e) => setFilterClas(e.target.value)}
              >
                <option value="">Todas las Clasificaciones</option>
                {clasificaciones.map((clas) => (
                  <option key={clas} value={clas}>{clas}</option>
                ))}
              </select>
              <select
                className="p-3 rounded-lg text-white custom-select"
                value={filterDate}
                onChange={(e) => setFilterDate(e.target.value)}
              >
                <option value="">Todas las Fechas</option>
                {fechas.map((fecha) => (
                  <option key={fecha} value={fecha}>{fecha}</option>
                ))}
              </select>
              <div className="flex items-center gap-2">
                <select
                  multiple
                  size="3"
                  className="p-3 rounded-lg text-white custom-select flex-1"
                  value={filterClients}
                  onChange={handleClientChange}
                >
                  <option value="">Todos los Clientes</option>
                  {clientes.map((cliente) => (
                    <option key={cliente} value={cliente}>{cliente}</option>
                  ))}
                </select>
                <button
                  onClick={resetClientFilter}
                  className="p-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors text-sm font-semibold"
                >
                  Reiniciar
                </button>
              </div>
            </div>
          </div>
          <div className="section-frame overflow-x-auto" ref={tableRef}>
            <table className="w-full text-left border-collapse bg-gray-900 shadow-2xl rounded-lg">
              <thead className="table-header text-white sticky top-0 z-10">
                <tr>
                  <th className="p-3">Vendedor</th>
                  <th className="p-3">Clasif.</th>
                  <th className="p-3">Descripción</th>
                  <th className="p-3">Cant.</th>
                  <th className="p-3">Importe</th>
                  <th className="p-3">Cliente</th>
                  <th className="p-3">Alm.</th>
                  <th className="p-3">Factura</th>
                  <th className="p-3">Fecha</th>
                </tr>
                <tr className="bg-green-400 text-black font-semibold">
                  <td className="p-3"></td>
                  <td className="p-3"></td>
                  <td className="p-3"></td>
                  <td className="p-3">{totals.cantidad.toLocaleString()}</td>
                  <td className="p-3">${totals.importe.toLocaleString()}</td>
                  <td className="p-3"></td>
                  <td className="p-3"></td>
                  <td className="p-3"></td>
                  <td className="p-3"></td>
                </tr>
              </thead>
              <tbody>
                {data.length === 0 ? (
                  <tr>
                    <td colSpan="9" className="p-3 text-blue-300 text-center">
                      Cargando datos desde Google Drive...
                    </td>
                  </tr>
                ) : filteredData.length === 0 ? (
                  <tr>
                    <td colSpan="9" className="p-3 text-blue-300 text-center">
                      No hay datos disponibles para los filtros seleccionados
                    </td>
                  </tr>
                ) : (
                  filteredData.map((item, index) => (
                    <tr key={index} className="border-b border-gray-700 hover:bg-gray-800 transition-colors">
                      <td className="p-3" style={{ color: vendorColors[item.codVend] || '#FFFFFF' }}>
                        {vendorNames[item.codVend] || item.codVend}
                      </td>
                      <td className="p-3">{item.clasificacion}</td>
                      <td className="p-3">{item.descripcion}</td>
                      <td className={`p-3 ${getColor(item.cantidad, "cantidad")}`}>{item.cantidad}</td>
                      <td className="p-3 text-green-300">${item.importe.toLocaleString()}</td>
                      <td className="p-3">{item.cliente}</td>
                      <td className="p-3">{item.almacen}</td>
                      <td className="p-3">{item.factura}</td>
                      <td className="p-3">{item.fecha}</td>
                    </tr>
                  ))
                )}
              </tbody>
            </table>
          </div>
          <button
            onClick={() => setView("home")}
            className="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-500 transition-colors font-semibold"
          >
            Volver al Inicio
          </button>
        </div>
      );

      const renderProspects = () => (
        <div className="space-y-6">
          <div className="bg-gradient-to-r from-blue-900 to-blue-500 p-6 rounded-xl shadow-lg text-center transform hover:scale-105 transition-transform">
            <h1 className="text-3xl sm:text-4xl font-extrabold text-white mb-2 tracking-wide header-3d">INTERFAZ - VTS - LLAN/AUT</h1>
            <p className="text-sm sm:text-base text-blue-100 header-3d">
              Información confidencial · Uso interno exclusivo · Prohibida su reproducción sin autorización
            </p>
          </div>
          <button
            onClick={() => setView("home")}
            className="bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors"
          >
            Volver al Inicio
          </button>
          <div className="flex flex-col items-center gap-4">
            <h2 className="text-2xl sm:text-3xl font-bold text-green-400 text-center">Filtros de Prospecciones</h2>
            <div className="grid grid-cols-1 sm:grid-cols-2 gap-4 w-full max-w-md">
              <div className="flex items-center gap-2">
                <select
                  multiple
                  size="3"
                  className="p-3 rounded-lg text-white custom-select flex-1"
                  value={prospectFilterVend}
                  onChange={handleProspectVendorChange}
                >
                  <option value="">Todos los Vendedores</option>
                  {prospectVendors.map((vendor) => (
                    <option key={vendor} value={vendor}>{vendor}</option>
                  ))}
                </select>
                <button
                  onClick={resetProspectVendorFilter}
                  className="p-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors text-sm"
                >
                  Reiniciar
                </button>
              </div>
              <div className="flex items-center gap-2">
                <select
                  className="p-3 rounded-lg text-white custom-select flex-1"
                  value={prospectFilterMonth}
                  onChange={(e) => setProspectFilterMonth(e.target.value)}
                >
                  <option value="">Todos los Meses</option>
                  {prospectMonths.map((month) => (
                    <option key={month} value={month}>{month}</option>
                  ))}
                </select>
                <button
                  onClick={resetProspectMonthFilter}
                  className="p-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors text-sm"
                >
                  Reiniciar
                </button>
              </div>
            </div>
          </div>
          <div className="bg-gray-800 p-4 rounded-lg shadow-lg">
            <h3 className="text-lg sm:text-xl font-semibold text-green-400 text-center mb-4">Prospecciones por Vendedor (Gráfica)</h3>
            {prospectError ? (
              <p className="text-red-400 text-center">{prospectError}</p>
            ) : prospectChartTotals.length === 0 ? (
              <p className="text-cyan-300 text-center">Cargando datos de prospecciones...</p>
            ) : (
              <div className="w-full h-[250px] sm:h-[350px]">
                <canvas ref={prospectChartRef}></canvas>
              </div>
            )}
          </div>
          <div className="space-y-4">
            <div className="bg-gray-800 p-3 rounded-lg shadow-lg">
              <h3 className="text-base sm:text-lg font-semibold text-green-400 text-center mb-3">Totales de Prospecciones por Vendedor</h3>
              <div className="flex flex-wrap justify-center gap-2">
                {Object.entries(prospectTotals).map(([vendor, count]) => (
                  <div
                    key={vendor}
                    className="bg-gradient-to-r from-green-600 to-teal-700 text-white p-2 rounded-lg shadow-md flex items-center gap-1 text-sm"
                  >
                    <span className="font-medium" style={{ color: getVendorColor(vendor) }}>
                      {vendor}:
                    </span>
                    <span className="text-base">{count}</span>
                  </div>
                ))}
              </div>
            </div>
            <div className="bg-gray-800 p-3 rounded-lg shadow-lg">
              <h3 className="text-base sm:text-lg font-semibold text-green-400 text-center mb-3">Prospecciones por Vendedor y Mes</h3>
              <div className="flex flex-wrap justify-center gap-2">
                {Object.entries(prospectTotalsByMonth).map(([vendor, months]) => (
                  <div key={vendor} className="bg-gray-700 p-2 rounded-lg shadow-md text-sm">
                    <span className="font-medium" style={{ color: getVendorColor(vendor) }}>
                      {vendor}:
                    </span>
                    <div className="ml-2">
                      {Object.entries(months).map(([month, count]) => (
                        <div key={month} className="text-white">
                          {month}: {count}
                        </div>
                      ))}
                    </div>
                  </div>
                ))}
              </div>
            </div>
            <div className="overflow-x-auto" ref={prospectTableRef}>
              <table className="w-full text-left border-collapse bg-gray-900 shadow-2xl rounded-lg">
                <thead className="prospect-table-header text-white sticky top-0 z-10">
                  <tr>
                    <th className="p-3">Vendedor</th>
                    <th className="p-3">Nombre del Cliente</th>
                    <th className="p-3">Giro del Negocio</th>
                    <th className="p-3">Zona</th>
                    <th className="p-3">Teléfono</th>
                    <th className="p-3">Dirección</th>
                    <th className="p-3">Fecha Visita 1</th>
                    <th className="p-3">¿Compra Llantas?</th>
                    <th className="p-3">¿Qué Marca?</th>
                    <th className="p-3">Mes</th>
                  </tr>
                </thead>
                <tbody>
                  {prospectData.length === 0 ? (
                    <tr>
                      <td colSpan="10" className="p-3 text-blue-300 text-center">
                        Cargando datos de prospecciones...
                      </td>
                    </tr>
                  ) : filteredProspectData.length === 0 ? (
                    <tr>
                      <td colSpan="10" className="p-3 text-blue-300 text-center">
                        No hay datos disponibles para los filtros seleccionados
                      </td>
                    </tr>
                  ) : (
                    filteredProspectData.map((item, index) => (
                      <tr key={index} className="border-b border-gray-700 hover:bg-gray-800 transition-colors">
                        <td className="p-3" style={{ color: getVendorColor(item["Vendedor"]) }}>
                          {item["Vendedor"] || "Desconocido"}
                        </td>
                        <td className="p-3">{item["Nombre del cliente"] || ""}</td>
                        <td className="p-3">{item["Giro del Negocio"] || ""}</td>
                        <td className="p-3">{item["Zona"] || ""}</td>
                        <td className="p-3">{item["Teléfono"] || ""}</td>
                        <td className="p-3">{item["Dirección"] || ""}</td>
                        <td className="p-3">{item["Hora de inicio"] || ""}</td>
                        <td className="p-3">{item["¿Compra llantas?"] || ""}</td>
                        <td className="p-3">{item["¿Qué marca?"] || ""}</td>
                        <td className="p-3">{getMonthName(item["Hora de inicio"])}</td>
                      </tr>
                    ))
                  )}
                </tbody>
              </table>
            </div>
          </div>
          <button
            onClick={() => setView("home")}
            className="bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors"
          >
            Volver al Inicio
          </button>
        </div>
      );

      return (
        <div>
          {view === "home" && renderHome()}
          {view === "leaders" && renderLeaders()}
          {view === "results" && renderResults()}
          {view === "prospects" && renderProspects()}
          {view === "formLinks" && renderFormLinks()}
          {view === "dailyReports" && renderDailyReports()}
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<SalesTable />);
  </script>
</body>
</html>